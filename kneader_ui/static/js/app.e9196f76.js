(()=>{"use strict";var t={479:(t,e,s)=>{var r=s(751),a=s(641);const n={id:"app"};function o(t,e,s,r,o,l){const c=(0,a.g2)("router-view");return(0,a.uX)(),(0,a.CE)("div",n,[e[0]||(e[0]=(0,a.Lk)("header",{class:"app-header"},[(0,a.Lk)("h1",null,"Kneader Controller System")],-1)),(0,a.Lk)("main",null,[(0,a.bF)(c)])])}const l={name:"App"};var c=s(262);const i=(0,c.A)(l,[["render",o]]),u=i;var d=s(220),p=s(33);const h={class:"dashboard"},k={key:0,class:"status-panel"},m={class:"status-info"},_={class:"status-item"},v={class:"value"},g={class:"status-item"},b={class:"value"},I={class:"status-item"},L={class:"status-item"},C={key:0,class:"status-item"},f={class:"value"},y={class:"control-buttons"},S={key:1,class:"stages-container"},E=["onClick"],w={class:"stage-header"},x={key:0,class:"mixing-badge"},X={class:"stage-content"},R={key:0,class:"timer"},O={key:0,class:"current-indicator"},W={class:"scanner-input"},M=["disabled"],P={key:1,class:"idle-message"},Q={key:2,class:"completion-panel"},T={key:3,class:"error-panel"},F={key:4,class:"modal"},D={class:"modal-content"},j={key:0};function A(t,e,s,n,o,l){return(0,a.uX)(),(0,a.CE)("div",h,["IDLE"!==o.status.process_state?((0,a.uX)(),(0,a.CE)("div",k,[e[13]||(e[13]=(0,a.Lk)("h2",null,"System Status",-1)),(0,a.Lk)("div",m,[(0,a.Lk)("div",_,[e[8]||(e[8]=(0,a.Lk)("span",{class:"label"},"Workorder ID:",-1)),(0,a.Lk)("span",v,(0,p.v_)(o.status.workorder_id),1)]),(0,a.Lk)("div",g,[e[9]||(e[9]=(0,a.Lk)("span",{class:"label"},"Current Stage:",-1)),(0,a.Lk)("span",b,(0,p.v_)(o.status.current_step_index+1)+" of "+(0,p.v_)(o.currentWorkorder.steps.length),1)]),(0,a.Lk)("div",I,[e[10]||(e[10]=(0,a.Lk)("span",{class:"label"},"Lid Status:",-1)),(0,a.Lk)("span",{class:(0,p.C4)(["value",o.status.lid_open?"open":"closed"])},(0,p.v_)(o.status.lid_open?"Open":"Closed"),3)]),(0,a.Lk)("div",L,[e[11]||(e[11]=(0,a.Lk)("span",{class:"label"},"Motor Status:",-1)),(0,a.Lk)("span",{class:(0,p.C4)(["value",o.status.motor_running?"running":"stopped"])},(0,p.v_)(o.status.motor_running?"Running":"Stopped"),3)]),o.status.mixing_time_remaining>0?((0,a.uX)(),(0,a.CE)("div",C,[e[12]||(e[12]=(0,a.Lk)("span",{class:"label"},"Time Remaining:",-1)),(0,a.Lk)("span",f,(0,p.v_)(o.status.mixing_time_remaining)+"s",1)])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",y,["MIXING"===o.status.process_state?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:e[0]||(e[0]=(...t)=>l.abortProcess&&l.abortProcess(...t)),class:"btn btn-danger"}," Abort ")):(0,a.Q3)("",!0),"ERROR"===o.status.process_state?((0,a.uX)(),(0,a.CE)("button",{key:1,onClick:e[1]||(e[1]=(...t)=>l.resetController&&l.resetController(...t)),class:"btn btn-warning"}," Reset ")):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0),"IDLE"!==o.status.process_state?((0,a.uX)(),(0,a.CE)("div",S,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.currentWorkorder.steps,(t,s)=>((0,a.uX)(),(0,a.CE)("div",{key:s,class:(0,p.C4)(["stage-card",{active:s===o.status.current_step_index,mixing:"MIXING"===o.status.process_state&&s===o.status.current_step_index}]),onClick:t=>l.showStageItems(s)},[(0,a.Lk)("div",w,[(0,a.Lk)("h3",null,"Stage "+(0,p.v_)(s+1),1),"MIXING"===o.status.process_state&&s===o.status.current_step_index?((0,a.uX)(),(0,a.CE)("span",x," Mixing ")):(0,a.Q3)("",!0)]),(0,a.Lk)("div",X,[(0,a.Lk)("p",null,[e[14]||(e[14]=(0,a.Lk)("strong",null,"Mix Time:",-1)),(0,a.eW)(" "+(0,p.v_)(t.mix_time_sec)+" seconds",1)]),(0,a.Lk)("p",null,[e[15]||(e[15]=(0,a.Lk)("strong",null,"Items:",-1)),(0,a.eW)(" "+(0,p.v_)(l.getScannedCount(s))+"/"+(0,p.v_)(t.items.length),1)]),"MIXING"===o.status.process_state&&s===o.status.current_step_index?((0,a.uX)(),(0,a.CE)("div",R,[e[16]||(e[16]=(0,a.Lk)("strong",null,"Time Remaining:",-1)),(0,a.eW)(" "+(0,p.v_)(o.status.mixing_time_remaining)+"s ",1)])):(0,a.Q3)("",!0)]),s===o.status.current_step_index?((0,a.uX)(),(0,a.CE)("div",O," Current Stage ")):(0,a.Q3)("",!0)],10,E))),128))])):(0,a.Q3)("",!0),(0,a.Lk)("div",{class:(0,p.C4)(["scanner-panel",{centered:"IDLE"===o.status.process_state}])},[e[18]||(e[18]=(0,a.Lk)("h3",null,"Item Scanner",-1)),(0,a.Lk)("div",W,[(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=t=>o.barcode=t),placeholder:"Enter barcode or scan item",onKeyup:e[3]||(e[3]=(0,r.jR)((...t)=>l.handleScan&&l.handleScan(...t),["enter"])),ref:"barcodeInput"},null,544),[[r.Jo,o.barcode]]),(0,a.Lk)("button",{onClick:e[4]||(e[4]=(...t)=>l.handleScan&&l.handleScan(...t)),disabled:!o.barcode||"IDLE"!==o.status.process_state&&"WAITING_FOR_ITEMS"!==o.status.process_state,class:"btn btn-primary"}," Scan ",8,M)]),o.scanResult?((0,a.uX)(),(0,a.CE)("div",{key:0,class:(0,p.C4)(["scan-result",o.scanResult.status])},(0,p.v_)(o.scanResult.message),3)):(0,a.Q3)("",!0),"IDLE"===o.status.process_state?((0,a.uX)(),(0,a.CE)("div",P,[...e[17]||(e[17]=[(0,a.Lk)("p",null,"Scan the first item of any workorder to begin",-1)])])):(0,a.Q3)("",!0)],2),"PROCESS_COMPLETE"===o.status.process_state?((0,a.uX)(),(0,a.CE)("div",Q,[e[19]||(e[19]=(0,a.Lk)("h2",null,"Process Completed Successfully!",-1)),(0,a.Lk)("button",{onClick:e[5]||(e[5]=(...t)=>l.resetController&&l.resetController(...t)),class:"btn btn-success"},"OK")])):(0,a.Q3)("",!0),"ERROR"===o.status.process_state?((0,a.uX)(),(0,a.CE)("div",T,[(0,a.Lk)("h2",null,"Error: "+(0,p.v_)(o.status.error_message),1),(0,a.Lk)("button",{onClick:e[6]||(e[6]=(...t)=>l.resetController&&l.resetController(...t)),class:"btn btn-warning"},"Reset Controller")])):(0,a.Q3)("",!0),o.showItemsModal?((0,a.uX)(),(0,a.CE)("div",F,[(0,a.Lk)("div",D,[(0,a.Lk)("span",{class:"close",onClick:e[7]||(e[7]=t=>o.showItemsModal=!1)},"Ã—"),(0,a.Lk)("h3",null,"Scanned Items for Stage "+(0,p.v_)(o.selectedStage+1),1),(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.scannedItems[o.selectedStage],(t,e)=>((0,a.uX)(),(0,a.CE)("li",{key:e},(0,p.v_)(t.name)+" ("+(0,p.v_)(t.item_id)+") ",1))),128))]),0===o.scannedItems[o.selectedStage].length?((0,a.uX)(),(0,a.CE)("p",j,"No items scanned yet")):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)])}var N=s(335);const G="http://localhost:5000/api",K=N.A.create({baseURL:G,timeout:1e4}),$=()=>K.get("/status").then(t=>t.data),U=t=>K.post("/scan",{barcode:t}).then(t=>t.data),J=()=>K.post("/control/abort").then(t=>t.data),V=()=>K.post("/control/reset").then(t=>t.data),q=()=>K.get("/workorders").then(t=>t.data),z={name:"Dashboard",data(){return{status:{process_state:"IDLE",lid_open:!0,motor_running:!1,current_step_index:-1,current_item_index:-1,mixing_time_remaining:0,error_message:"",workorder_id:null},workorders:[],currentWorkorder:null,scannedItems:[],barcode:"",scanResult:null,showItemsModal:!1,selectedStage:0,statusInterval:null}},async mounted(){await this.loadWorkorders(),this.startStatusPolling(),this.$refs.barcodeInput.focus()},beforeUnmount(){this.stopStatusPolling()},methods:{async loadWorkorders(){try{this.workorders=await q()}catch(t){console.error("Failed to load workorders:",t)}},startStatusPolling(){this.statusInterval=setInterval(this.updateStatus,1e3)},stopStatusPolling(){this.statusInterval&&(clearInterval(this.statusInterval),this.statusInterval=null)},async updateStatus(){try{const t=await $();if(this.status=t,t.workorder_id&&!this.currentWorkorder&&(this.currentWorkorder=this.workorders.find(e=>e.workorder_id===t.workorder_id),this.currentWorkorder&&(this.scannedItems=Array(this.currentWorkorder.steps.length).fill().map(()=>[]))),this.currentWorkorder&&t.current_step_index>=0){const e=t.current_step_index,s=t.current_item_index;if(s>0&&this.scannedItems[e].length<s){const t=this.currentWorkorder.steps[e].items.slice(this.scannedItems[e].length,s);this.scannedItems[e].push(...t)}}"WAITING_FOR_ITEMS"!==t.process_state&&"IDLE"!==t.process_state||this.$nextTick(()=>{this.$refs.barcodeInput.focus()})}catch(t){console.error("Failed to update status:",t)}},async handleScan(){if(this.barcode.trim())try{const t=await U(this.barcode.trim());this.scanResult=t,"success"===t.status&&(this.barcode="",this.$refs.barcodeInput.focus())}catch(t){console.error("Failed to scan item:",t),this.scanResult={status:"error",message:"Scan failed"}}},getScannedCount(t){return this.scannedItems[t]?this.scannedItems[t].length:0},showStageItems(t){this.selectedStage=t,this.showItemsModal=!0},async abortProcess(){try{await J()}catch(t){console.error("Failed to abort process:",t)}},async resetController(){try{await V(),this.currentWorkorder=null,this.scannedItems=[],this.barcode="",this.scanResult=null,this.$refs.barcodeInput.focus()}catch(t){console.error("Failed to reset controller:",t)}}}},B=(0,c.A)(z,[["render",A],["__scopeId","data-v-74d8f050"]]),H=B,Y=[{path:"/",name:"Dashboard",component:H}],Z=(0,d.aE)({history:(0,d.LA)("/"),routes:Y}),tt=Z;(0,r.Ef)(u).use(tt).mount("#app")}},e={};function s(r){var a=e[r];if(void 0!==a)return a.exports;var n=e[r]={exports:{}};return t[r](n,n.exports,s),n.exports}s.m=t,(()=>{var t=[];s.O=(e,r,a,n)=>{if(!r){var o=1/0;for(u=0;u<t.length;u++){for(var[r,a,n]=t[u],l=!0,c=0;c<r.length;c++)(!1&n||o>=n)&&Object.keys(s.O).every(t=>s.O[t](r[c]))?r.splice(c--,1):(l=!1,n<o&&(o=n));if(l){t.splice(u--,1);var i=a();void 0!==i&&(e=i)}}return e}n=n||0;for(var u=t.length;u>0&&t[u-1][2]>n;u--)t[u]=t[u-1];t[u]=[r,a,n]}})(),(()=>{s.d=(t,e)=>{for(var r in e)s.o(e,r)&&!s.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}})(),(()=>{s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()})(),(()=>{s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e)})(),(()=>{s.r=t=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}})(),(()=>{var t={524:0};s.O.j=e=>0===t[e];var e=(e,r)=>{var a,n,[o,l,c]=r,i=0;if(o.some(e=>0!==t[e])){for(a in l)s.o(l,a)&&(s.m[a]=l[a]);if(c)var u=c(s)}for(e&&e(r);i<o.length;i++)n=o[i],s.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return s.O(u)},r=self["webpackChunkkneader_ui"]=self["webpackChunkkneader_ui"]||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))})();var r=s.O(void 0,[504],()=>s(479));r=s.O(r)})();
//# sourceMappingURL=app.e9196f76.js.map